# v3.0.5 - Engine V3 Live

**Release Date:** 2026-01-23

## Overview

This release makes Engine V3 production-ready with the `ops:run:v3` command for continuous automated matching operations and adds the `taxonomy:overlap` dashboard for cross-venue topic coverage analysis.

## New Commands

### `ops:run:v3` - V3 Operations Runner

Full V3 operational loop orchestrating:
1. `v3:suggest-matches` per topic
2. Auto-confirm (using pipeline rules)
3. Auto-reject (using pipeline rules)
4. Watchlist sync
5. Quotes freshness check
6. KPI summary

```bash
# Dry-run (default)
node services/worker/dist/cli.js ops:run:v3 --topics RATES

# Apply changes
node services/worker/dist/cli.js ops:run:v3 --topics CRYPTO_DAILY,MACRO,RATES --apply

# With taxonomy maintenance
node services/worker/dist/cli.js ops:run:v3 --with-taxonomy-maintenance --apply
```

**Options:**
- `--topics <topics>` - Comma-separated topics (default: CRYPTO_DAILY,CRYPTO_INTRADAY,MACRO,RATES)
- `--apply` - Apply changes (default: dry-run)
- `--with-taxonomy-maintenance` - Run events/series sync
- `--from <venue>` / `--to <venue>` - Source/target venues
- `--lookback-hours <N>` - Eligibility window (default: 720)
- `--limit-left <N>` / `--limit-right <N>` - Market limits
- `--max-per-left <N>` / `--max-per-right <N>` - Suggestions caps
- `--min-score <N>` - Minimum score threshold (default: 0.60)

### `taxonomy:overlap` - Topic Overlap Dashboard

Cross-venue market distribution per CanonicalTopic within eligibility window.

```bash
# Default (720h lookback)
node services/worker/dist/cli.js taxonomy:overlap

# Custom lookback with CSV output
node services/worker/dist/cli.js taxonomy:overlap --lookback-hours 168 --out overlap.csv
```

**Output columns:**
- `topic` - CanonicalTopic
- `leftCount` - Kalshi market count
- `rightCount` - Polymarket market count
- `overlapPresence` - Both sides have markets
- `matchable` - Pipeline exists for topic
- `pipelineName` - Registered pipeline version

Shows sample titles when zero overlap for diagnosis.

## RATES Pipeline Updates (v3.0.5)

Updated to `v3@3.0.5:RATES`:

- **Auto-confirm threshold:** >= 0.88 (was 0.85)
- **Date check:** Exact OR within 1 day (was exact only)
- **Text sanity:** >= 0.12 (was 0.15)
- **Safe rule:** `RATES_EXACT_MATCH`

### RATES Auto-Confirm Conditions
- Score >= 0.88
- Central bank exact match
- Meeting date exact OR +/- 1 day
- Action exact match
- BPS exact (or both missing)
- Text sanity >= 0.12

### RATES Auto-Reject Conditions
- Score < 0.55
- Action conflict (CUT vs HIKE)

## Scoring & Dedup

- Scores normalized to [0..1] range
- Dedup caps: `maxPerLeft=3`, `maxPerRight=8`
- Winner gap: 0.08 (top candidate must beat second by this margin)

## Files Changed

**New:**
- `services/worker/src/commands/ops-run-v3.ts`
- `services/worker/src/commands/taxonomy-overlap.ts`

**Modified:**
- `services/worker/src/cli.ts` - New command registrations
- `services/worker/src/commands/index.ts` - New exports
- `services/worker/src/matching/pipelines/ratesPipeline.ts` - v3.0.5 updates

## Testing

```bash
# Run RATES pipeline tests
npx tsx --test services/worker/src/matching/pipelines/ratesPipeline.test.ts

# Run signal extraction tests
npx tsx --test services/worker/src/matching/signals/ratesSignals.test.ts

# Test taxonomy:overlap
node services/worker/dist/cli.js taxonomy:overlap --lookback-hours 168

# Test ops:run:v3 (dry-run)
node services/worker/dist/cli.js ops:run:v3 --topics RATES
```

## Migration Notes

No database migrations required. Commands are additive.

## Verified On Server

- Server: 64.111.93.112
- Both commands tested and working
- RATES pipeline: 352 suggested, 20 auto-confirmed, 37 auto-rejected in test run
